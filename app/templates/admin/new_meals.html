{% extends "admin/base.html" %}

{% block page_css %}
<link rel="stylesheet" href="{{ css_root }}/allergy_table.css">
<link rel="stylesheet" href="{{ css_root }}/new_meals.css">
{% endblock %}

{% block content %}
<h2>新規メニュー登録</h2>

<p class="description-text">
  アレルギー解析で新しく検出されたメニューです。<br>
  一か月メニューPDFを確認し、正式名称を入力してください。
</p>

<form id="new-meals-form" method="post" action="/api/admin/allergy_admin/new_meals">

  <table class="new-meal-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>正式名称（必須）</th>
        <th>ふりがな</th>
        <th>kcal</th>
        <th>タンパク質</th>
        <th>脂質</th>
        <th>炭水化物</th>
        <th>塩分</th>
      </tr>
    </thead>

    <tbody>
      {% for meal_id in new_meal_ids %}
      <tr>

        <!-- ID（hidden + 表示） -->
        <td class="meal-id">
          {{ meal_id }}
          <input type="hidden" name="items[{{ loop.index0 }}][meal_id]" value="{{ meal_id }}">
        </td>

        <!-- 名称 -->
        <td>
          <input type="text" name="items[{{ loop.index0 }}][meal_name]" placeholder="メニュー名" class="input-text">
        </td>

        <!-- ふりがな -->
        <td>
          <input type="text" name="items[{{ loop.index0 }}][furigana]" placeholder="ふりがな" class="input-text">
        </td>

        <!-- kcal -->
        <td>
          <input type="number" step="0.1" name="items[{{ loop.index0 }}][kcal]" class="input-num">
        </td>

        <!-- protein -->
        <td>
          <input type="number" step="0.1" name="items[{{ loop.index0 }}][protein]" class="input-num">
        </td>

        <!-- fat -->
        <td>
          <input type="number" step="0.1" name="items[{{ loop.index0 }}][fat]" class="input-num">
        </td>

        <!-- carb -->
        <td>
          <input type="number" step="0.1" name="items[{{ loop.index0 }}][carb]" class="input-num">
        </td>

        <!-- salt -->
        <td>
          <input type="number" step="0.1" name="items[{{ loop.index0 }}][salt]" class="input-num">
        </td>

      </tr>
      {% endfor %}
    </tbody>
  </table>
  <input type="hidden" name="token" value="{{ token }}">
  <button type="submit" id="register-all" class="primary-button">すべて登録する</button>

</form>

{% endblock %}

{% block page_js %}
<script src="{{ js_root }}/new_meals.js"></script>
{% endblock %}